#!/bin/bash

set -eux

REFERENCE_GENOME=${1:-GRCh38}
VEP_DOCKER_IMAGE="gcr.io/seqr-project/vep-docker-image"

case $REFERENCE_GENOME in
  GRCh38)
    ;;
  GRCh37)
    ;;
   *)
    echo "Invalid reference genome $REFERENCE_GENOME, should be GRCh37 or GRCh38"
    exit 1
esac

# NB: the vep_data volume reference isn't absolute... couldn't get it to work.
docker run --platform linux/amd64 -i -v ~/vep_data/$REFERENCE_GENOME:/opt/vep/.vep/:ro $VEP_DOCKER_IMAGE:$REFERENCE_GENOME \
  /opt/vep/src/ensembl-vep/vep $@
